<ion-header>
  <ion-toolbar color="primary">
    <ion-title>Főoldal</ion-title>
    <ion-button slot="end" fill="clear" color="danger" (click)="logout()">Kijelentkezés</ion-button>
  </ion-toolbar>
</ion-header>
<ion-content class="ion-padding">
  <div class="card-list">
    <ion-card (click)="quickPhotoUpload()">
      <ion-card-header>
        <ion-card-title>Gyors blokk feltöltés (fotó vagy fájl)</ion-card-title>
      </ion-card-header>
      <ion-card-content>
        Készíts képet vagy válassz ki egy blokk fotót a feltöltéshez.
        <ion-button expand="block" color="primary" (click)="quickPhotoUpload()" [disabled]="loading">
          <ion-icon name="camera" slot="start"></ion-icon>
          Kép készítése
        </ion-button>
        <ion-button expand="block" color="secondary" (click)="fileInput.click()" [disabled]="loading">
          <ion-icon name="folder" slot="start"></ion-icon>
          Fájl kiválasztása
        </ion-button>
        <input #fileInput type="file" accept="image/*" style="display: none;" (change)="onFileSelected($event)">
        
        <!-- Töltési állapot megjelenítése -->
        <div *ngIf="loading" class="upload-status">
          <div class="upload-header">
            <ion-spinner name="crescent"></ion-spinner>
            <ion-label>Blokk feldolgozása...</ion-label>
          </div>
          <div class="progress-container">
            <div class="progress-bar">
              <div class="progress-fill" [style.width.%]="uploadProgress"></div>
            </div>
            <div class="progress-text">{{ uploadProgress | number:'1.0-0' }}%</div>
          </div>
          <ion-label class="upload-message">
            <span *ngIf="uploadProgress < 30">Kép feldolgozása...</span>
            <span *ngIf="uploadProgress >= 30 && uploadProgress < 70">AI elemzés...</span>
            <span *ngIf="uploadProgress >= 70 && uploadProgress < 100">Adatok mentése...</span>
            <span *ngIf="uploadProgress >= 100">Sikeres!</span>
          </ion-label>
        </div>
      </ion-card-content>
    </ion-card>
    
    <ion-card (click)="goTo('receipts')" [class.disabled]="loading">
      <ion-card-header>
        <ion-card-title>Blokkok kezelése</ion-card-title>
      </ion-card-header>
      <ion-card-content>
        Feltöltés, lista, szerkesztés, törlés.
      </ion-card-content>
    </ion-card>
    
    <ion-card (click)="goTo('stats')" [class.disabled]="loading">
      <ion-card-header>
        <ion-card-title>Statisztikák</ion-card-title>
      </ion-card-header>
      <ion-card-content>
        Kimutatások, grafikonok, összesítések.
      </ion-card-content>
    </ion-card>
    
    <ng-container *ngIf="userProfile$ | async as user">
      <ion-card *ngIf="user.roles && user.roles.includes('admin')" (click)="goTo('admin')" [class.disabled]="loading">
        <ion-card-header>
          <ion-card-title>Admin felület</ion-card-title>
        </ion-card-header>
        <ion-card-content>
          Felhasználók, jogosultságok, admin funkciók.
        </ion-card-content>
      </ion-card>
    </ng-container>
  </div>

  <!-- Toast üzenetek -->
  <ion-toast
    [isOpen]="showToast"
    [message]="toastMessage"
    duration="3000"
    position="top">
  </ion-toast>
</ion-content> 